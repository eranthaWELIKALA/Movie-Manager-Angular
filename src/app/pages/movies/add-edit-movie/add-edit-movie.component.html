<div class="container">
    <div *ngIf="!fileImport" class="card">
        <div class="imageArea">
            <img id="watchedIcon" *ngIf="movie.watched" src="../../../../assets/watched.png" class="card-img-top" alt="...">
            <img [attr.src]="movie.imagePath == 'url/image'? getSantizeUrl('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNTAgMjUwIj4KICAgIDxwYXRoIGZpbGw9IiNERDAwMzEiIGQ9Ik0xMjUgMzBMMzEuOSA2My4ybDE0LjIgMTIzLjFMMTI1IDIzMGw3OC45LTQzLjcgMTQuMi0xMjMuMXoiIC8+CiAgICA8cGF0aCBmaWxsPSIjQzMwMDJGIiBkPSJNMTI1IDMwdjIyLjItLjFWMjMwbDc4LjktNDMuNyAxNC4yLTEyMy4xTDEyNSAzMHoiIC8+CiAgICA8cGF0aCAgZmlsbD0iI0ZGRkZGRiIgZD0iTTEyNSA1Mi4xTDY2LjggMTgyLjZoMjEuN2wxMS43LTI5LjJoNDkuNGwxMS43IDI5LjJIMTgzTDEyNSA1Mi4xem0xNyA4My4zaC0zNGwxNy00MC45IDE3IDQwLjl6IiAvPgogIDwvc3ZnPg=='):movie.imagePath" class="card-img-top" alt="...">          
        </div>
        <div class="card-body">            
            <form (ngSubmit)="addEditMovie(addEditMovieForm)" #addEditMovieForm="ngForm">
                <div class="form-group">
                    <div class="row">
                        <div class="col-md-3">
                            <label>Title</label>
                        </div>
                        <div class="col-md-9">
                            <input class="form-control" type="text" id="title" [(ngModel)]="movie.title" name="title" #title="ngModel" required>                                                   
                            <div class="validationErrors" *ngIf="submitted && title.control.errors">
                                <p *ngIf="title.control.errors?.required">Title can not be empty</p>
                            </div>
                        </div>
                    </div>          
                    <div class="row">
                        <div class="col-md-3">
                            <label>Description</label>
                        </div>
                        <div class="col-md-9">
                            <input class="form-control" type="text" id="description" [(ngModel)]="movie.description" name="description" #description="ngModel" required>                                                   
                            <div class="validationErrors" *ngIf="submitted && description.control.errors">
                                <p *ngIf="description.control.errors?.required">Description can not be empty</p>
                            </div>
                        </div>
                    </div>          
                    <div class="row">
                        <div class="col-md-3">
                            <label>Year</label>
                        </div>
                        <div class="col-md-9">
                            <input class="form-control" type="number" id="year" [(ngModel)]="movie.year" name="year" #year="ngModel">   
                        </div>
                    </div>          
                    <div class="row">
                        <div class="col-md-3">
                            <label>Cast</label>
                        </div>
                        <div class="col-md-9">
                            <input class="form-control" type="text" id="cast" [(ngModel)]="movie.cast" name="cast" #cast="ngModel"> 
                        </div>
                    </div>          
                    <div class="row">
                        <div class="col-md-3">
                            <label>Language</label>
                        </div>
                        <div class="col-md-9">
                            <select class="form-control" id="languageId" [(ngModel)]="movie.languageId" name="languageId" #languageId="ngModel" required>
                                <option *ngFor="let language of languages" [value]="language.id">{{language.language}}</option>
                            </select>                                                   
                            <div class="validationErrors" *ngIf="submitted && languageId.control.errors">
                                <p *ngIf="languageId.control.errors?.required">Required to select a Language</p>
                            </div>
                        </div>
                    </div>          
                    <div class="row">
                        <div class="col-md-3">
                            <label>Location</label>
                        </div>
                        <div class="col-md-9">
                            <select class="form-control" id="locationId" [(ngModel)]="movie.locationId" name="locationId" #locationId="ngModel" required>
                                <option *ngFor="let location of locations" [value]="location.id">{{location.name}}</option>
                            </select>                                                   
                            <div class="validationErrors" *ngIf="submitted && locationId.control.errors">
                                <p *ngIf="locationId.control.errors?.required">Required to select a Location</p>
                            </div>
                        </div>
                    </div>          
                    <div class="row">
                        <div class="col-md-3">
                            <label>Location Path</label>
                        </div>
                        <div class="col-md-9">
                            <input class="form-control" type="text" id="locationPath" [(ngModel)]="movie.locationPath" name="locationPath" #locationPath="ngModel" required>                                                   
                            <div class="validationErrors" *ngIf="submitted && locationPath.control.errors">
                                <p *ngIf="locationPath.control.errors?.required">Location path can not be empty</p>
                            </div>
                        </div>
                    </div>         
                    <div class="row">
                        <div class="col-md-3">
                            <label>Image URL</label>
                        </div>
                        <div class="col-md-9">
                            <input class="form-control" type="text" id="imagePath" [(ngModel)]="movie.imagePath" name="imagePath" #imagePath="ngModel">     
                        </div>
                    </div>           
                    <div class="row">
                        <div class="col-md-3">
                            <label>Watched</label>
                        </div>
                        <div class="col-md-9">
                            <select class="form-control" id="watched" [(ngModel)]="movie.watched" name="watched" #watched="ngModel" required>
                                <option [ngValue]="true">Yes</option>
                                <option [ngValue]="false">No</option>
                                </select>                                                   
                                <div class="validationErrors" *ngIf="submitted && watched.control.errors">
                                    <p *ngIf="watched.control.errors?.required">Required to select an option</p>
                                </div>
                        </div>
                    </div>             
                    <div class="row">
                        <div class="col-md-12">
                            <button class="form-control btn btn-primary" type="submit">Add</button>
                        </div>
                    </div>           
                    <div class="row">
                        <div id="addSpreadsheet" class="col-md-12">
                            <a (click)="showFileImport(true)">Add using a spreadsheet</a>
                        </div>
                    </div>
                </div>
            </form>
        </div>
      </div>
    <div *ngIf="fileImport" class="card">
        <div class="card-body">            
            <div class="form-group">
                <div class="row">
                    <div class="col-md-3">
                        <label>Import</label>
                    </div>
                    <div class="col-md-9">        
                        <input class="form-control" type="file" id="file" name="file" (change)="addfile($event)" placeholder="Upload file" accept=".csv,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel">        
                      </div> 
                </div>            
                <div class="row">
                    <div id="addSpreadsheet" class="col-md-12">
                        <a (click)="showFileImport(false)">Go back to manual import</a>
                    </div>
                </div>
            </div>

            <form *ngIf="headers != null && rows != null" (ngSubmit)="addEditMoviesList()" #addEditMoviesListForm="ngForm">
                <div class="form-group">
                    <div class="row">
                        <div class="col-md-3">
                            <label>Title</label>
                        </div>
                        <div class="col-md-5 col-sm-9">                            
                            <select *ngIf="movieList.titleColumn.selection == '' && movieList.titleColumn.select" class="form-control" id="titleColumn" [(ngModel)]="movieList.titleColumn.selection" name="titleColumn" #titleColumn="ngModel" required (change)="columnSelected(titleColumn, 'titleColumn')">
                                <option *ngFor="let header of headers; index as t" [value]="t">{{header}}</option>
                            </select>
                            <input *ngIf="movieList.titleColumn.selection != '' && movieList.titleColumn.select" class="form-control" type="text" id="selectedTitleColumn" [(ngModel)]="headers[movieList.titleColumn.selection]" name="selectedTitleColumn" #selectedTitleColumn="ngModel" readonly>
                            <input *ngIf="!movieList.titleColumn.select" class="form-control" type="text" id="titleValueColumn" [(ngModel)]="movieList.titleColumn.value" name="titleValueColumn" #titleValueColumn="ngModel">
                        </div>                        
                        <div class="col-md-2 col-sm-9">  
                            <a class="form-control btn btn-danger" [hidden]="movieList.titleColumn.selection == '' || !movieList.titleColumn.select" (click)="removeSelectedColumn('titleColumn')">Clear</a>  
                        </div>                    
                        <div class="col-md-2 col-sm-9">   
                            <a class="form-control btn btn-primary" (click)="typeColumnValue('titleColumn')">{{movieList.titleColumn.select?'Type': 'Select'}}</a>
                        </div>
                    </div>          
                    <div class="row">
                        <div class="col-md-3">
                            <label>Description</label>
                        </div>
                        <div class="col-md-5 col-sm-9">                         
                            <select *ngIf="movieList.descriptionColumn.selection == ''" class="form-control" id="descriptionColumn" [(ngModel)]="movieList.descriptionColumn.selection" name="descriptionColumn" #descriptionColumn="ngModel" required (change)="columnSelected(descriptionColumn, 'descriptionColumn')">
                                <option *ngFor="let header of headers; index as t" [value]="t">{{header}}</option>
                            </select>
                            <input *ngIf="movieList.descriptionColumn.selection != ''" class="form-control" type="text" id="selectedDescriptionColumn" [(ngModel)]="headers[movieList.descriptionColumn.selection]" name="selectedDescriptionColumn" #selectedDescriptionColumn="ngModel" readonly>
                        </div>                     
                        <div class="col-md-2 col-sm-9">  
                            <a class="form-control btn btn-danger" [hidden]="movieList.descriptionColumn.selection == ''" (click)="removeSelectedColumn('descriptionColumn')">Clear</a>
                        </div>
                    </div>          
                    <div class="row">
                        <div class="col-md-3">
                            <label>Year</label>
                        </div>
                        <div class="col-md-5 col-sm-9">                         
                            <select *ngIf="movieList.yearColumn.selection == ''" class="form-control" id="yearColumn" [(ngModel)]="movieList.yearColumn.selection" name="yearColumn" #yearColumn="ngModel" required (change)="columnSelected(yearColumn, 'yearColumn')">
                                <option *ngFor="let header of headers; index as t" [value]="t">{{header}}</option>
                            </select>
                            <input *ngIf="movieList.yearColumn.selection != ''" class="form-control" type="text" id="selectedYearColumn" [(ngModel)]="headers[movieList.yearColumn.selection]" name="selectedYearColumn" #selectedYearColumn="ngModel" readonly>
                        </div>                     
                        <div class="col-md-2 col-sm-9">  
                            <a class="form-control btn btn-danger" [hidden]="movieList.yearColumn.selection == ''" (click)="removeSelectedColumn('yearColumn')">Clear</a>
                        </div>
                    </div>          
                    <div class="row">
                        <div class="col-md-3">
                            <label>Cast</label>
                        </div>
                        <div class="col-md-5 col-sm-9">                         
                            <select *ngIf="movieList.castColumn.selection == ''" class="form-control" id="castColumn" [(ngModel)]="movieList.castColumn.selection" name="castColumn" #castColumn="ngModel" required (change)="columnSelected(castColumn, 'castColumn')">
                                <option *ngFor="let header of headers; index as t" [value]="t">{{header}}</option>
                            </select>
                            <input *ngIf="movieList.castColumn.selection != ''" class="form-control" type="text" id="selectedCastColumn" [(ngModel)]="headers[movieList.castColumn.selection]" name="selectedCastColumn" #selectedCastColumn="ngModel" readonly>
                        </div>                     
                        <div class="col-md-2 col-sm-9">  
                            <a class="form-control btn btn-danger" [hidden]="movieList.castColumn.selection == ''" (click)="removeSelectedColumn('castColumn')">Clear</a>
                        </div>
                    </div>  
                    <div class="row">
                        <div class="col-md-3">
                            <label>Language</label>
                        </div>
                        <div class="col-md-5 col-sm-9">                        
                            <select *ngIf="movieList.languageColumn.selection == ''" class="form-control" id="languageColumn" [(ngModel)]="movieList.languageColumn.selection" name="languageColumn" #languageColumn="ngModel" required>
                                <option *ngFor="let language of languages" [value]="language.id">{{language.language}}</option>
                            </select>
                            <input *ngIf="movieList.languageColumn.selection != ''" class="form-control" type="text" id="selectedLanguageColumn" [(ngModel)]="headers[movieList.languageColumn.selection]" name="selectedLanguageColumn" #selectedLanguageColumn="ngModel" readonly>
                        </div>                     
                        <div class="col-md-2 col-sm-9">  
                            <a class="form-control btn btn-danger" [hidden]="movieList.languageColumn.selection == ''" (click)="removeSelectedColumn('languageColumn')">Clear</a>
                        </div>
                    </div>          
                    <div class="row">
                        <div class="col-md-3">
                            <label>Location</label>
                        </div>
                        <div class="col-md-5 col-sm-9">                         
                            <select *ngIf="movieList.locationColumn.selection == ''" class="form-control" id="locationColumn" [(ngModel)]="movieList.locationColumn.selection" name="locationColumn" #locationColumn="ngModel" required>
                                <option *ngFor="let location of locations" [value]="location.id">{{location.name}}</option>
                            </select>
                            <input *ngIf="movieList.locationColumn.selection != ''" class="form-control" type="text" id="selectedLocationColumn" [(ngModel)]="headers[movieList.locationColumn.selection]" name="selectedLocationColumn" #selectedLocationColumn="ngModel" readonly>
                        </div>                     
                        <div class="col-md-2 col-sm-9">  
                            <a class="form-control btn btn-danger" [hidden]="movieList.locationColumn.selection == ''" (click)="removeSelectedColumn('locationColumn')">Clear</a>
                        </div>
                    </div>        
                    <div class="row">
                        <div class="col-md-3">
                            <label>Location Path</label>
                        </div>
                        <div class="col-md-5 col-sm-9">                         
                            <select *ngIf="movieList.locationPathColumn.selection == ''" class="form-control" id="locationPathColumn" [(ngModel)]="movieList.locationPathColumn.selection" name="locationPathColumn" #locationPathColumn="ngModel" required (change)="columnSelected(locationPathColumn, 'locationPathColumn')">
                                <option *ngFor="let header of headers; index as t" [value]="t">{{header}}</option>
                            </select>
                            <input *ngIf="movieList.locationPathColumn.selection != ''" class="form-control" type="text" id="selectedLocationPathColumn" [(ngModel)]="headers[movieList.locationPathColumn.selection]" name="selectedLocationPathColumn" #selectedLocationPathColumn="ngModel" readonly>
                        </div>                     
                        <div class="col-md-2 col-sm-9">  
                            <a class="form-control btn btn-danger" [hidden]="movieList.locationPathColumn.selection == ''" (click)="removeSelectedColumn('locationPathColumn')">Clear</a>
                        </div>
                    </div>         
                    <div class="row">
                        <div class="col-md-3">
                            <label>Image URL</label>
                        </div>
                        <div class="col-md-5 col-sm-9">                         
                            <select *ngIf="movieList.imagePathColumn.selection == ''" class="form-control" id="imagePathColumn" [(ngModel)]="movieList.imagePathColumn.selection" name="imagePathColumn" #imagePathColumn="ngModel" required (change)="columnSelected(imagePathColumn, 'imagePathColumn')">
                                <option *ngFor="let header of headers; index as t" [value]="t">{{header}}</option>
                            </select>
                            <input *ngIf="movieList.imagePathColumn.selection != ''" class="form-control" type="text" id="selectedImagePathColumn" [(ngModel)]="headers[movieList.imagePathColumn.selection]" name="selectedImagePathColumn" #selectedImagePathColumn="ngModel" readonly>
                        </div>                 
                        <div class="col-md-2 col-sm-9">  
                            <a class="form-control btn btn-danger" [hidden]="movieList.imagePathColumn.selection == ''" (click)="removeSelectedColumn('imagePathColumn')">Clear</a>
                        </div>
                    </div>           
                    <div class="row">
                        <div class="col-md-3">
                            <label>Watched</label>
                        </div>
                        <div class="col-md-5 col-sm-9">                         
                            <select *ngIf="movieList.watchedColumn.selection == ''" class="form-control" id="watchedColumn" [(ngModel)]="movieList.watchedColumn.selection" name="watchedColumn" #watchedColumn="ngModel" required (change)="columnSelected(watchedColumn, 'watchedColumn')">
                                <option *ngFor="let header of headers; index as t" [value]="header">{{header}}</option>
                            </select>
                            <input *ngIf="movieList.watchedColumn.selection != ''" class="form-control" type="text" id="selectedWatchedColumn" [(ngModel)]="headers[movieList.watchedColumn.selection]" name="selectedWatchedColumn" #selectedWatchedColumn="ngModel" readonly>
                        </div>                     
                        <div class="col-md-2 col-sm-9">  
                            <a class="form-control btn btn-danger" [hidden]="movieList.watchedColumn.selection == ''" (click)="removeSelectedColumn('watchedColumn')">Clear</a>
                        </div>
                    </div>             
                    <div class="row">
                        <div class="col-md-12">
                            <button class="form-control btn btn-primary" type="submit">Add</button>
                        </div>
                    </div>    
                </div>
            </form>

            <table class="table table-striped table-hover">
                <thead>                    
                    <tr>
                        <th *ngFor="let header of headers">{{header}}</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let row of rows">
                        <td *ngFor="let column of row">{{column}}</td>
                    </tr>
                </tbody>
            </table>

        </div>
    </div>
</div>